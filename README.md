# ğŸŒ å°æ™º Moji åœ°å€å¤©æ°”æ˜¾ç¤ºåŠŸèƒ½

<div align="center">

![ESP32](https://img.shields.io/badge/ESP32-S3-red?style=for-the-badge&logo=espressif)
![LVGL](https://img.shields.io/badge/LVGL-9.2.2-blue?style=for-the-badge)
![C++](https://img.shields.io/badge/C++-17-green?style=for-the-badge&logo=c%2B%2B)
![License](https://img.shields.io/badge/License-MIT-yellow?style=for-the-badge)

**ä¸ºå°æ™º Moji ESP32-S3 è®¾å¤‡æ·»åŠ å®æ—¶åœ°å€å’Œå¤©æ°”æ˜¾ç¤ºåŠŸèƒ½ï¼Œæä¾› Moon åŒæ¬¾è¡¨ç›˜æ ·å¼**

[ğŸ“– åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§) â€¢ [âš™ï¸ å¿«é€Ÿé…ç½®](#å¿«é€Ÿé…ç½®) â€¢ [ğŸ”§ å®‰è£…æŒ‡å—](#å®‰è£…æŒ‡å—) â€¢ [ğŸ“Š API ä¿¡æ¯](#api-æœåŠ¡ä¿¡æ¯) â€¢ [â“ æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)

</div>

---

## ğŸš€ åŠŸèƒ½æ¦‚è¿°

æœ¬é¡¹ç›®å°†åŸæœ‰çš„å†œå†æ˜¾ç¤ºåŠŸèƒ½å‡çº§ä¸ºæ™ºèƒ½åœ°å€å’Œå¤©æ°”æ˜¾ç¤ºç³»ç»Ÿï¼Œä¸ºå°æ™º Moji ESP32-S3 è®¾å¤‡æä¾› Moon åŒæ¬¾è¡¨ç›˜æ ·å¼ï¼š

- ğŸ“ **å®æ—¶åœ°å€å®šä½** - åŸºäºè…¾è®¯åœ°å›¾ IP å®šä½ API
- ğŸŒ¤ï¸ **å®æ—¶å¤©æ°”ä¿¡æ¯** - åŸºäºå¿ƒçŸ¥å¤©æ°” API  
- â° **æ™ºèƒ½æ˜¾ç¤ºåˆ‡æ¢** - 15ç§’åœ°å€/20ç§’å¤©æ°”äº¤æ›¿æ˜¾ç¤º
- ğŸ”„ **è‡ªåŠ¨æ›´æ–°æœºåˆ¶** - å¼€æœºæ›´æ–°ä¸€æ¬¡ï¼Œåç»­æ¯2å°æ—¶è‡ªåŠ¨æ›´æ–°
- ğŸ—ºï¸ **å†…ç½®åŸå¸‚æ•°æ®åº“** - åŒ…å«3218ä¸ªåŸå¸‚çš„ç²¾ç¡®åæ ‡
- ğŸ¨ **Moon è¡¨ç›˜æ ·å¼** - é‡‡ç”¨ä¸ Moon è®¾å¤‡ç›¸åŒçš„ç•Œé¢è®¾è®¡å’Œæ˜¾ç¤ºé£æ ¼

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ“± æ˜¾ç¤ºé€»è¾‘
| åŠŸèƒ½ | æ˜¾ç¤ºæ—¶é•¿ | æ›´æ–°é¢‘ç‡ | æ•°æ®æº |
|------|----------|----------|--------|
| ğŸ“ åœ°å€æ˜¾ç¤º | 15ç§’ | å¼€æœº+2å°æ—¶ | è…¾è®¯åœ°å›¾ API |
| ğŸŒ¤ï¸ å¤©æ°”æ˜¾ç¤º | 20ç§’ | å¼€æœº+2å°æ—¶ | å¿ƒçŸ¥å¤©æ°” API |
| ğŸ”„ å¾ªç¯å‘¨æœŸ | 35ç§’ | è‡ªåŠ¨åˆ‡æ¢ | - |

### ğŸ“Š æ•°æ®æ ¼å¼ç¤ºä¾‹
```
ğŸ“ åœ°å€: å¹¿ä¸œçœ æ·±åœ³å¸‚ å—å±±åŒº
ğŸŒ¤ï¸ å¤©æ°”: 32Â°C æ™´
ğŸ—ºï¸ åæ ‡: 22.5360Â°N, 113.9256Â°E
```

### ğŸ”§ æŠ€æœ¯ç‰¹æ€§
- âœ… **HTTP åè®®** - é¿å… SSL è¯ä¹¦é—®é¢˜
- âœ… **é”™è¯¯å¤„ç†** - å®Œæ•´çš„ç½‘ç»œå¼‚å¸¸å¤„ç†
- âœ… **å†…å­˜ä¼˜åŒ–** - åŸå¸‚æ•°æ®åº“å ç”¨ä»… 369KB
- âœ… **WiFi æ£€æµ‹** - ä»…åœ¨ç½‘ç»œè¿æ¥æ—¶æ›´æ–°
- âœ… **æ—¥å¿—è®°å½•** - è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯è¾“å‡º
- âœ… **Moon é£æ ¼** - é‡‡ç”¨ä¸ Moon è®¾å¤‡ä¸€è‡´çš„ UI è®¾è®¡è¯­è¨€

## âš™ï¸ å¿«é€Ÿé…ç½®

### 1ï¸âƒ£ è·å– API Key

#### ğŸ“ è…¾è®¯ä½ç½®æœåŠ¡ API
1. è®¿é—® [è…¾è®¯ä½ç½®æœåŠ¡æ§åˆ¶å°](https://lbs.qq.com/)
2. æ³¨å†Œå¹¶ç™»å½•è´¦å·
3. åˆ›å»ºåº”ç”¨ï¼Œé€‰æ‹©"WebServiceAPI"
4. å¤åˆ¶ç”Ÿæˆçš„ Key

#### ğŸŒ¤ï¸ å¿ƒçŸ¥å¤©æ°” API  
1. è®¿é—® [å¿ƒçŸ¥å¤©æ°”å®˜ç½‘](https://www.seniverse.com/)
2. æ³¨å†Œå¹¶ç™»å½•è´¦å·
3. åˆ›å»ºåº”ç”¨ï¼Œé€‰æ‹©"å¤©æ°”æ•°æ®"
4. å¤åˆ¶ç”Ÿæˆçš„ Key

### 2ï¸âƒ£ é…ç½® API Key

#### è…¾è®¯ä½ç½®æœåŠ¡ API Key
éœ€è¦åœ¨ä¸¤ä¸ªä½ç½®é…ç½®ï¼š

**ä½ç½®1ï¼š** `main/boards/movecall-moji-esp32s3/location_display.cc` (ç¬¬15è¡Œ)
```cpp
static std::string api_key = "ä½ çš„è…¾è®¯APIå¯†é’¥";
```

**ä½ç½®2ï¼š** `main/boards/movecall-moji-esp32s3/movecall_moji_esp32s3.cc` (ç¬¬142è¡Œ)
```cpp
LocationDisplay::SetApiKey("ä½ çš„è…¾è®¯APIå¯†é’¥");
```

#### å¿ƒçŸ¥å¤©æ°” API Key
**æ–‡ä»¶ä½ç½®ï¼š** `main/boards/movecall-moji-esp32s3/movecall_moji_esp32s3.cc` (ç¬¬147è¡Œ)

```cpp
WeatherDisplay::SetApiKey("ä½ çš„å¿ƒçŸ¥å¤©æ°”APIå¯†é’¥");
```

### 3ï¸âƒ£ ESP-IDF é…ç½®

#### å¯ç”¨ TabView æ”¯æŒ
1. è¿è¡Œ `idf.py menuconfig`æˆ–è€…ä½¿ç”¨vscode idfæ’ä»¶è¿›å…¥sdké…ç½®ï¼ˆæ¨èï¼‰
2. å¯¼èˆªåˆ° `Component config` â†’ `LVGL configuration` â†’ `Widgets`
3. å¯ç”¨ `TABVIEW`
4. ä¿å­˜é…ç½®

#### é€‰æ‹©è®¾å¤‡å‹å·
1. åœ¨ `Board Options` ä¸­é€‰æ‹© `mojiå°æ™ºè¡ç”Ÿç‰ˆ`
2. ä¿å­˜é…ç½®

## ğŸ“ é¡¹ç›®ç»“æ„

```
main/boards/movecall-moji-esp32s3/
â”œâ”€â”€ ğŸ“„ movecall_moji_esp32s3.cc    # ä¸»ç•Œé¢æ–‡ä»¶ï¼ˆä¿®æ”¹ï¼ŒMoon é£æ ¼ï¼‰
â”œâ”€â”€ ğŸ“„ location_display.h          # åœ°å€æ˜¾ç¤ºæ¨¡å—å¤´æ–‡ä»¶ï¼ˆæ–°å¢ï¼‰
â”œâ”€â”€ ğŸ“„ location_display.cc         # åœ°å€æ˜¾ç¤ºæ¨¡å—å®ç°ï¼ˆæ–°å¢ï¼‰
â”œâ”€â”€ ğŸ“„ weather_display.h           # å¤©æ°”æ˜¾ç¤ºæ¨¡å—å¤´æ–‡ä»¶ï¼ˆæ–°å¢ï¼‰
â”œâ”€â”€ ğŸ“„ weather_display.cc          # å¤©æ°”æ˜¾ç¤ºæ¨¡å—å®ç°ï¼ˆæ–°å¢ï¼‰
â”œâ”€â”€ ğŸ“„ city_data.h                 # åŸå¸‚åæ ‡æ•°æ®ï¼ˆæ–°å¢ï¼‰
â”œâ”€â”€ ğŸ“„ city_data_impl.cc           # åŸå¸‚åæ ‡æŸ¥æ‰¾å®ç°ï¼ˆæ–°å¢ï¼‰
â”œâ”€â”€ ğŸ csv_to_cpp.py              # CSVè½¬C++ä»£ç ç”Ÿæˆè„šæœ¬ï¼ˆæ–°å¢ï¼‰
â””â”€â”€ ğŸ§ª test_location_api.py       # APIæµ‹è¯•è„šæœ¬ï¼ˆæ–°å¢ï¼‰
```

## ğŸ“Š API æœåŠ¡ä¿¡æ¯

### ğŸ“ è…¾è®¯åœ°å›¾ IP å®šä½ API
| é¡¹ç›® | è¯¦æƒ… |
|------|------|
| **æœåŠ¡åœ°å€** | `http://apis.map.qq.com/ws/location/v1/ip` |
| **è¯·æ±‚æ–¹å¼** | GET |
| **å‚æ•°** | `key` (APIå¯†é’¥) |
| **è¿”å›æ ¼å¼** | JSON |
|              |                                            |

### ğŸŒ¤ï¸ å¿ƒçŸ¥å¤©æ°” API
| é¡¹ç›® | è¯¦æƒ… |
|------|------|
| **æœåŠ¡åœ°å€** | `http://api.seniverse.com/v3/weather/now.json` |
| **è¯·æ±‚æ–¹å¼** | GET |
| **å‚æ•°** | `key`, `location`, `language`, `unit` |
| **è¿”å›æ ¼å¼** | JSON |
|  |  |

## â“ æ•…éšœæ’é™¤

### ğŸ” å¸¸è§é—®é¢˜

#### 1. SSL é”™è¯¯ `mbedtls_ssl_fetch_input error=29312`
**è¯´æ˜ï¼š** è¿™æ˜¯ ESP-IDF å†…éƒ¨ SSL åº“é—®é¢˜ï¼Œä¸å½±å“åŠŸèƒ½
**è§£å†³æ–¹æ¡ˆï¼š** å¯ä»¥å¿½ç•¥ï¼Œä»£ç å·²ä½¿ç”¨ HTTP åè®®é¿å… SSL é—®é¢˜

### ğŸ”§ è°ƒè¯•ä¿¡æ¯

é¡¹ç›®åŒ…å«è¯¦ç»†çš„æ—¥å¿—è¾“å‡ºï¼Œå¯é€šè¿‡ä¸²å£ç›‘è§†å™¨æŸ¥çœ‹ï¼š

```bash
# åœ°å€è·å–è¿‡ç¨‹
I (5679) LocationDisplay: è·å–åˆ°åœ°å€: å¹¿ä¸œçœ æ·±åœ³å¸‚ å—å±±åŒº

# å¤©æ°”è¯·æ±‚çŠ¶æ€  
I (5809) WeatherDisplay: å¤©æ°”HTTPçŠ¶æ€ç : 200
I (5809) WeatherDisplay: è·å–åˆ°å¤©æ°”: æ·±åœ³ 32Â°C æ™´

# åŸå¸‚åæ ‡æŸ¥æ‰¾ç»“æœ
I (5689) WeatherDisplay: æ„å»ºåŸå¸‚å: å¹¿ä¸œ/æ·±åœ³/å—å±±
```

## âš ï¸ æ³¨æ„äº‹é¡¹

| é¡¹ç›® | è¯´æ˜ |
|------|------|
| ğŸ”¢ **API é™åˆ¶** | æ³¨æ„å„ API çš„å…è´¹ä½¿ç”¨é¢åº¦ |
| ğŸŒ **ç½‘ç»œä¾èµ–** | åŠŸèƒ½éœ€è¦ç¨³å®šçš„ç½‘ç»œè¿æ¥ |
| ğŸ’¾ **å†…å­˜ä½¿ç”¨** | åŸå¸‚åæ ‡æ•°æ®åº“å ç”¨çº¦ 369KB Flash ç©ºé—´ |
| â±ï¸ **æ›´æ–°é¢‘ç‡** | å»ºè®®ä¸è¦è¿‡äºé¢‘ç¹åœ°æ›´æ–°æ•°æ®ä»¥é¿å…è¶…å‡º API é™åˆ¶ |
| ğŸ¨ **ç•Œé¢é£æ ¼** | é‡‡ç”¨ Moon è®¾å¤‡çš„è¡¨ç›˜è®¾è®¡é£æ ¼ï¼Œä¿æŒè§†è§‰ä¸€è‡´æ€§ |

## ğŸ¤ è´¡çŒ®æŒ‡å—

> **è¯¥ç‰ˆæœ¬ä¸ä¼šèŠ±æ—¶é—´ç»´æŠ¤æ›´æ–°ï¼Œæœ‰ç²¾åŠ›çš„å¼€å‘è€…å¯ä»¥ï¼š**
> - ğŸ”„ Fork æ­¤ä»“åº“è‡ªè¡Œä¿®æ”¹ä¸Šä¼ 
> - ğŸ“ ç”³è¯· Pull Request åˆ°æ­¤ä»“åº“
> - ğŸ› æäº¤ Issue æŠ¥å‘Šé—®é¢˜
> - ğŸ’¡ æå‡ºåŠŸèƒ½å»ºè®®

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

---

<div align="center">

**ğŸŒŸ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™å®ƒä¸€ä¸ª Starï¼**

Made with â¤ï¸ for xiaozhi â€¢ Moon é£æ ¼è¡¨ç›˜

</div>

   

